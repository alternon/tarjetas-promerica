/* ==========================================================================
   Carousel
   ========================================================================== */
$('.carousel').carousel({
    interval: 5000
});
/* ==========================================================================
   NAV responsive
   ========================================================================== */
$("#open_nav, #close_nav").click(function () {
    $("#main_nav").toggleClass("active");
});
$("#main_nav .menu > li").click(function () {
    $(this).children("ul").toggleClass("expand");
});

/* ==========================================================================
   Bienvenido
   ========================================================================== */
$(".select_country .dropdown li").click(function () {
    $(this).parent("ul").children("li").removeClass("active");
    $(this).addClass("active");
    var url = $(this).data("val");
    var txt = $(this).text();
    $(".select_country .btn-default").attr("href", url).removeClass("disabled");;
    $(".select_country_btn").text(txt);
});

/* ==========================================================================
   Next & Prev - pagination
   ========================================================================== */
var $tabs = $('.pagination li');
$('.prev_btn').on('click', function () {
    $tabs.filter('.active').prev('li').find('a[data-toggle="tab"]').tab('show');
});
$('.next_btn').on('click', function () {
    $tabs.filter('.active').next('li').find('a[data-toggle="tab"]').tab('show');
});

/* ==========================================================================
   Checkbox contacto
   ========================================================================== */
$(".nav_map label").click(function () {
    if ($(this).find("input").is(":checked")) {
        $(this).addClass("active");
    } else {
        $(this).removeClass("active");
    }
});

/* ==========================================================================
   Filtros por categoria
   ========================================================================== */
$(".cobranded1").attr("data-default", "true");

$('.filter').jplist({
    debug: false,
    historyLength: 10,

    animateToTop: '.nav-pills',

    itemsBox: '.filter_wrapper>.row>div',
    itemPath: '.filter_item',
    panelPath: '.filter_wrapper',

    effect: 'fade',
    duration: 300,
    fps: 100
});

$(".nav-pills>li>a").click(function () {
    $(".nav-pills>li").removeClass("active");
    $(this).parent("li").addClass("active");
});

/* ==========================================================================
   Scrollbar tablas
   ========================================================================== */
$("table").wrap("<div class='scrollbarx'></div>");

/* ==========================================================================
   Scrollbar
   ========================================================================== */
$(".scrollbar").mCustomScrollbar({
    axis: "y"
});
$(".scrollbarx").mCustomScrollbar({
    axis: "x"
});

/* ==========================================================================
   Tipo de cambio
   ========================================================================== */
$(".tipo_cambio nav a").click(function () {
    $(".tipo_cambio nav a").removeClass("active");
    $(this).addClass("active");
});

/* ==========================================================================
   Agregar input
   ==========================================================================  */

$(".show_input input").keyup(function (e) {
    $(this).parents("tr").find("label.error").css("display", "none");
    $(this).parents("tr").find("input").removeClass("error");
});

$(".add_input").click(function () {
    if (!($(this).hasClass("disabled") || $(this).parents("tr").find(".add_input_beneficiario").val() == "" || $(this).parents("tr").find(".add_input_aporte").val() == "")) {
        $(this).addClass("disabled");
        $(this).parents("tr").next()
            .removeClass("hide")
            .addClass("show_input")
            .find("input")
              .prop("disabled", false);
        $(".show_input").last().find(".add_input").removeClass("disabled");
    } else {
        $(this).parents("tr").find("input").addClass("error");
    }
});

$(".remove_input").click(function () {
    if (!($(this).hasClass("disabled"))) {
        $(this).parents("tr")
            .appendTo("tbody")
            .addClass("hide")
            .removeClass("show_input")
            .find("input").val("")
              .prop("disabled", true);
        $(".show_input").last().find(".add_input").removeClass("disabled");
    }
});


/* ==========================================================================
   Convertir automaticamente a moneda
   ========================================================================== */
// Convertir automaticamente a moneda
$('.currency').focusout(function () {
    var decimal_length = 0;
    
    if (this.readOnly == true) {
        decimal_length = 2;
    }
    if ($(this).hasClass('cordobas')) {
        $(this).formatCurrency({ colorize: true, negativeFormat: '-%s%n', roundToDecimalPlace: decimal_length, symbol: 'C$ ', filterKeys: true });
    } else if ($(this).hasClass('euros')) {
        $(this).formatCurrency({ colorize: true, negativeFormat: '-%s%n', roundToDecimalPlace: decimal_length, symbol: ' ' + String.fromCharCode(8364) + ' ', filterKeys: true });
    } else {
        $(this).formatCurrency({ colorize: true, negativeFormat: '-%s%n', roundToDecimalPlace: decimal_length, symbol: ' $ ', filterKeys: true });
    }
}).keyup(function (e) {
    var e = window.event || e;
    var keyUnicode = e.charCode || e.keyCode;
    if (e !== undefined) {
        switch (keyUnicode) {
            default:
                if ($(this).hasClass('cordobas')) {
                    $(this).formatCurrency({ colorize: true, negativeFormat: '-%s%n', roundToDecimalPlace: -1, eventOnDecimalsEntered: true, symbol: 'C$ ', filterKeys: true });
                } else if ($(this).hasClass('euros')) {
                    $(this).formatCurrency({ colorize: true, negativeFormat: '-%s%n', roundToDecimalPlace: -1, eventOnDecimalsEntered: true, symbol: ' ' + String.fromCharCode(8364) + ' ', filterKeys: true });
                } else {
                    $(this).formatCurrency({ colorize: true, negativeFormat: '-%s%n', roundToDecimalPlace: -1, eventOnDecimalsEntered: true, symbol: ' $ ', filterKeys: true });
                }
        }
    }
});
// Cambia el tipo de la moneda con el select con clase "change_currency"
$(".change_currency").change(function () {
    $('.calc_content').fadeOut(0);
    $('.currency').val("");
    $('.currency').prop("disabled", false);

    if ($(this).val() == "") {
        $('.currency').prop("disabled", true);
        $('.currency').removeClass("euros");
        $('.currency').removeClass("dolares");
        $('.currency').removeClass("cordobas");
    } else if ($(this).val() == "60") {
        $('.currency').removeClass("euros");
        $('.currency').removeClass("dolares");
        $('.currency').addClass("cordobas");
    } else if ($(this).val() == "62") {
        $('.currency').removeClass("cordobas");
        $('.currency').removeClass("dolares");
        $('.currency').addClass("euros");
    } else {
        $('.currency').removeClass("61");
        $('.currency').removeClass("euros");
        $('.currency').removeClass("cordobas");
        $('.currency').addClass("dolares");
    }
});
// Agrega simbolo a los input de porcentaje
if (!($(".porcentaje").val() == "")) {
    $(".porcentaje").val(function (i, val) {
        return val + ' %';
    });
} else {
    $(".porcentaje").keyup(function (e) {
        var value = $(this).val().replace(' ', '').replace('%', '');
        $(this).val(value + " %");
    });
}


/* ==========================================================================
   Ajusta automaticamente el alto del textarea
   ========================================================================== */
autosize($('textarea'));

/* ==========================================================================
   Input date
   ========================================================================== */
$('.datepicker').datepicker();

/* ==========================================================================
   Formulario especifico
   ========================================================================== */

$( ".roChange input, .roChange select" ).attr( "disabled", "true" ).attr( "readonly", "true" );
//$(".roChange4").css("opacity", "1");

$("#tipo").change(function () {
    var val = $(this).val();

    $( ".roChange input, .roChange select" ).attr( "disabled", "true" ).attr( "readonly", "true" );

    $( ".roChange" ).css( "opacity", "0.2" );

    if ( val == 1 ) {
        $( ".roChange1, .roChange4" ).css( "opacity", "1" );
        $(".roChange1 input, .roChange1 select, .roChange4 input, .roChange4 select").removeAttr("disabled").removeAttr("readonly");
    } else if ( val == 2 ) {
        $(".roChange2, .roChange4 ").css("opacity", "1");
        $(".roChange2 input, .roChange2 select, .roChange4 input, .roChange4 select").removeAttr("disabled").removeAttr("readonly");
    } else {
        $( ".roChange3" ).css( "opacity", "1" );
        $(".roChange3 input, .roChange3 select").removeAttr("disabled").removeAttr("readonly");
    }
});
